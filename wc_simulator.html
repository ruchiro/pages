<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>2026 FIFA World Cup Interactive Bracket</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #1e3c72 0%, #2a5298 100%);
            padding: 20px;
            min-height: 100vh;
        }
        
        .container {
            max-width: 1600px;
            margin: 0 auto;
            background: white;
            border-radius: 12px;
            padding: 30px;
            box-shadow: 0 10px 40px rgba(0,0,0,0.3);
        }
        
        h1 {
            text-align: center;
            color: #1e3c72;
            margin-bottom: 10px;
            font-size: 2.5em;
        }
        
        .subtitle {
            text-align: center;
            color: #666;
            margin-bottom: 30px;
            font-size: 1.1em;
        }
        
        .tabs {
            display: flex;
            gap: 10px;
            margin-bottom: 30px;
            border-bottom: 2px solid #e0e0e0;
            flex-wrap: wrap;
        }
        
        .tab {
            padding: 12px 24px;
            background: #f5f5f5;
            border: none;
            border-radius: 8px 8px 0 0;
            cursor: pointer;
            font-size: 16px;
            font-weight: 600;
            transition: all 0.3s;
            color: #666;
        }
        
        .tab:hover {
            background: #e8e8e8;
        }
        
        .tab.active {
            background: #1e3c72;
            color: white;
        }
        
        .tab-content {
            display: none;
        }
        
        .tab-content.active {
            display: block;
        }
        
        .groups-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }
        
        .group {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            border-radius: 10px;
            padding: 20px;
            color: white;
            box-shadow: 0 4px 15px rgba(0,0,0,0.2);
        }
        
        .group-header {
            font-size: 1.5em;
            font-weight: bold;
            margin-bottom: 15px;
            text-align: center;
            border-bottom: 2px solid rgba(255,255,255,0.3);
            padding-bottom: 10px;
        }
        
        .team {
            padding: 10px;
            margin: 8px 0;
            background: rgba(255,255,255,0.15);
            border-radius: 6px;
            cursor: pointer;
            transition: all 0.3s;
            border-left: 3px solid transparent;
        }
        
        .team:hover {
            background: rgba(255,255,255,0.25);
            transform: translateX(5px);
        }
        
        .team.winner {
            background: rgba(76, 175, 80, 0.3);
            border-left-color: #4CAF50;
        }
        
        .team.runner-up {
            background: rgba(33, 150, 243, 0.3);
            border-left-color: #2196F3;
        }
        
        .team.third-place {
            background: rgba(255, 193, 7, 0.3);
            border-left-color: #FFC107;
        }
        
        .bracket-container {
            overflow-x: auto;
            padding: 20px 0;
        }
        
        .bracket {
            display: flex;
            gap: 40px;
            min-width: 1400px;
            justify-content: center;
        }
        
        .round {
            display: flex;
            flex-direction: column;
            justify-content: space-around;
            min-width: 200px;
        }
        
        .round-title {
            text-align: center;
            font-weight: bold;
            font-size: 1.2em;
            margin-bottom: 20px;
            color: #1e3c72;
            padding: 10px;
            background: #f0f0f0;
            border-radius: 8px;
        }
        
        .match {
            background: white;
            border: 2px solid #e0e0e0;
            border-radius: 8px;
            margin: 10px 0;
            padding: 15px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
            transition: all 0.3s;
        }
        
        .match:hover {
            box-shadow: 0 4px 15px rgba(0,0,0,0.2);
            border-color: #1e3c72;
        }
        
        .match-team {
            padding: 8px 12px;
            margin: 5px 0;
            background: #f8f8f8;
            border-radius: 5px;
            cursor: pointer;
            transition: all 0.3s;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        
        .match-team:hover {
            background: #e8f4f8;
        }
        
        .match-team.selected {
            background: #4CAF50;
            color: white;
            font-weight: bold;
        }
        
        .legend {
            display: flex;
            gap: 30px;
            justify-content: center;
            margin: 30px 0;
            padding: 20px;
            background: #f8f8f8;
            border-radius: 10px;
            flex-wrap: wrap;
        }
        
        .legend-item {
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .legend-box {
            width: 30px;
            height: 30px;
            border-radius: 5px;
        }
        
        .winner-box { background: rgba(76, 175, 80, 0.5); border: 2px solid #4CAF50; }
        .runner-up-box { background: rgba(33, 150, 243, 0.5); border: 2px solid #2196F3; }
        .third-place-box { background: rgba(255, 193, 7, 0.5); border: 2px solid #FFC107; }
        
        .instructions {
            background: #fff3cd;
            border: 2px solid #ffc107;
            border-radius: 10px;
            padding: 15px;
            margin-bottom: 20px;
            text-align: center;
            color: #856404;
        }
        
        .reset-btn {
            display: block;
            margin: 20px auto;
            padding: 12px 30px;
            background: #dc3545;
            color: white;
            border: none;
            border-radius: 8px;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s;
        }
        
        .reset-btn:hover {
            background: #c82333;
            transform: scale(1.05);
        }

        .champion-display {
            text-align: center;
            margin-top: 30px;
            padding: 30px;
            background: linear-gradient(135deg, #FFD700 0%, #FFA500 100%);
            border-radius: 15px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.3);
        }

        .champion-display h2 {
            font-size: 2.5em;
            color: #1e3c72;
            margin-bottom: 10px;
        }

        .champion-display .champion-name {
            font-size: 3em;
            font-weight: bold;
            color: white;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.3);
        }

        .playoff-match {
            margin-top: 10px;
        }

        .playoff-team {
            padding: 10px;
            margin: 5px 0;
            background: rgba(255,255,255,0.25);
            border-radius: 6px;
            cursor: pointer;
            transition: all 0.3s;
            border-left: 3px solid transparent;
        }

        .playoff-team:hover:not([style*="cursor: not-allowed"]) {
            background: rgba(255,255,255,0.4);
            transform: translateX(3px);
        }

        .playoff-team.selected {
            background: rgba(76, 175, 80, 0.5);
            border-left-color: #4CAF50;
            font-weight: bold;
        }

        #workflowGuide {
            transition: all 0.5s ease;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>üèÜ 2026 FIFA World Cup</h1>
        <p class="subtitle">Complete Tournament Simulator: Playoffs ‚Üí Group Stage ‚Üí Knockout Rounds</p>
        
        <div id="workflowGuide" style="background: linear-gradient(135deg, #4CAF50 0%, #45a049 100%); color: white; padding: 15px 25px; border-radius: 10px; margin-bottom: 20px; text-align: center; font-weight: 600; box-shadow: 0 4px 15px rgba(0,0,0,0.2);">
            <span id="guideText">üëâ Step 1: Complete the Playoffs to determine all 48 teams!</span>
        </div>
        
        <div class="tabs">
            <button class="tab active" onclick="showTab('playoffs')">1. Playoffs (March 2026)</button>
            <button class="tab" onclick="showTab('groups')">2. Group Stage (June 2026)</button>
            <button class="tab" onclick="showTab('bracket')">3. Knockout Stage (June-July 2026)</button>
        </div>
        
        <div id="playoffs" class="tab-content active">
            <div class="instructions">
                <strong>World Cup Playoffs - March 2026:</strong> Click on teams to select winners. 
                Winners will automatically populate their designated groups. 
                UEFA playoffs: March 26-31. Inter-confederation playoffs: March 23-31 in Mexico.
            </div>

            <h2 style="text-align: center; color: #1e3c72; margin: 30px 0 20px 0;">Inter-Confederation Playoffs</h2>
            <p style="text-align: center; color: #666; margin-bottom: 30px;">Venues: Estadio Akron (Guadalajara) & Estadio BBVA (Monterrey), Mexico</p>
            
            <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(450px, 1fr)); gap: 30px; margin-bottom: 50px;">
                <div style="background: linear-gradient(135deg, #11998e 0%, #38ef7d 100%); border-radius: 12px; padding: 25px; color: white; box-shadow: 0 4px 15px rgba(0,0,0,0.2);">
                    <h3 style="text-align: center; font-size: 1.5em; margin-bottom: 20px; border-bottom: 2px solid rgba(255,255,255,0.3); padding-bottom: 10px;">PATH 1</h3>
                    <div style="background: rgba(255,255,255,0.15); border-radius: 8px; padding: 15px; margin: 10px 0;">
                        <strong>Semifinal:</strong><br>
                        <div class="playoff-match">
                            <div class="playoff-team" onclick="selectPlayoffWinner('inter-path1-semi', 'New Caledonia')" id="inter-path1-semi-newcaledonia">New Caledonia</div>
                            <div class="playoff-team" onclick="selectPlayoffWinner('inter-path1-semi', 'Jamaica')" id="inter-path1-semi-jamaica">Jamaica</div>
                        </div>
                    </div>
                    <div style="text-align: center; margin: 15px 0; font-size: 1.5em;">‚¨á</div>
                    <div style="background: rgba(255,255,255,0.15); border-radius: 8px; padding: 15px; margin: 10px 0;">
                        <strong>Final:</strong><br>
                        <div class="playoff-match">
                            <div class="playoff-team" onclick="selectPlayoffWinner('inter-path1-final', 'Congo DR')" id="inter-path1-final-congodr">Congo DR</div>
                            <div class="playoff-team" id="inter-path1-final-semifinalist" style="opacity: 0.5; cursor: not-allowed;">Winner of Semifinal</div>
                        </div>
                    </div>
                    <div style="text-align: center; margin-top: 15px; padding: 10px; background: rgba(255,215,0,0.3); border-radius: 6px; font-weight: bold;">
                        ‚Üí Group K (FIFA Play-Off Tournament 1)
                    </div>
                </div>

                <div style="background: linear-gradient(135deg, #11998e 0%, #38ef7d 100%); border-radius: 12px; padding: 25px; color: white; box-shadow: 0 4px 15px rgba(0,0,0,0.2);">
                    <h3 style="text-align: center; font-size: 1.5em; margin-bottom: 20px; border-bottom: 2px solid rgba(255,255,255,0.3); padding-bottom: 10px;">PATH 2</h3>
                    <div style="background: rgba(255,255,255,0.15); border-radius: 8px; padding: 15px; margin: 10px 0;">
                        <strong>Semifinal:</strong><br>
                        <div class="playoff-match">
                            <div class="playoff-team" onclick="selectPlayoffWinner('inter-path2-semi', 'Bolivia')" id="inter-path2-semi-bolivia">Bolivia</div>
                            <div class="playoff-team" onclick="selectPlayoffWinner('inter-path2-semi', 'Suriname')" id="inter-path2-semi-suriname">Suriname</div>
                        </div>
                    </div>
                    <div style="text-align: center; margin: 15px 0; font-size: 1.5em;">‚¨á</div>
                    <div style="background: rgba(255,255,255,0.15); border-radius: 8px; padding: 15px; margin: 10px 0;">
                        <strong>Final:</strong><br>
                        <div class="playoff-match">
                            <div class="playoff-team" onclick="selectPlayoffWinner('inter-path2-final', 'Iraq')" id="inter-path2-final-iraq">Iraq</div>
                            <div class="playoff-team" id="inter-path2-final-semifinalist" style="opacity: 0.5; cursor: not-allowed;">Winner of Semifinal</div>
                        </div>
                    </div>
                    <div style="text-align: center; margin-top: 15px; padding: 10px; background: rgba(255,215,0,0.3); border-radius: 6px; font-weight: bold;">
                        ‚Üí Group I (FIFA Play-Off Tournament 2)
                    </div>
                </div>
            </div>

            <h2 style="text-align: center; color: #1e3c72; margin: 30px 0 20px 0;">European (UEFA) Playoffs</h2>
            <p style="text-align: center; color: #666; margin-bottom: 30px;">Semifinals: March 26 | Finals: March 31</p>
            
            <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(450px, 1fr)); gap: 30px;">
                <div style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); border-radius: 12px; padding: 25px; color: white; box-shadow: 0 4px 15px rgba(0,0,0,0.2);">
                    <h3 style="text-align: center; font-size: 1.5em; margin-bottom: 20px; border-bottom: 2px solid rgba(255,255,255,0.3); padding-bottom: 10px;">PATH A</h3>
                    <div style="background: rgba(255,255,255,0.15); border-radius: 8px; padding: 15px; margin: 10px 0;">
                        <strong>Semifinal 1:</strong><br>
                        <div class="playoff-match">
                            <div class="playoff-team" onclick="selectPlayoffWinner('uefa-a-semi1', 'Italy')" id="uefa-a-semi1-italy">Italy</div>
                            <div class="playoff-team" onclick="selectPlayoffWinner('uefa-a-semi1', 'Northern Ireland')" id="uefa-a-semi1-northernireland">Northern Ireland</div>
                        </div>
                    </div>
                    <div style="background: rgba(255,255,255,0.15); border-radius: 8px; padding: 15px; margin: 10px 0;">
                        <strong>Semifinal 2:</strong><br>
                        <div class="playoff-match">
                            <div class="playoff-team" onclick="selectPlayoffWinner('uefa-a-semi2', 'Wales')" id="uefa-a-semi2-wales">Wales</div>
                            <div class="playoff-team" onclick="selectPlayoffWinner('uefa-a-semi2', 'Bosnia and Herzegovina')" id="uefa-a-semi2-bosnia">Bosnia and Herzegovina</div>
                        </div>
                    </div>
                    <div style="text-align: center; margin: 15px 0; font-size: 1.5em;">‚¨á</div>
                    <div style="background: rgba(255,255,255,0.25); border-radius: 8px; padding: 15px; margin: 10px 0; font-weight: bold;">
                        <strong>Final:</strong><br>
                        <div class="playoff-match">
                            <div class="playoff-team" id="uefa-a-final-semi1" style="opacity: 0.5; cursor: not-allowed;">Winner Semi 1</div>
                            <div class="playoff-team" id="uefa-a-final-semi2" style="opacity: 0.5; cursor: not-allowed;">Winner Semi 2</div>
                        </div>
                    </div>
                    <div style="text-align: center; margin-top: 15px; padding: 10px; background: rgba(255,215,0,0.3); border-radius: 6px; font-weight: bold;">
                        ‚Üí Group B (European Play-Off A)
                    </div>
                </div>

                <div style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); border-radius: 12px; padding: 25px; color: white; box-shadow: 0 4px 15px rgba(0,0,0,0.2);">
                    <h3 style="text-align: center; font-size: 1.5em; margin-bottom: 20px; border-bottom: 2px solid rgba(255,255,255,0.3); padding-bottom: 10px;">PATH B</h3>
                    <div style="background: rgba(255,255,255,0.15); border-radius: 8px; padding: 15px; margin: 10px 0;">
                        <strong>Semifinal 1:</strong><br>
                        <div class="playoff-match">
                            <div class="playoff-team" onclick="selectPlayoffWinner('uefa-b-semi1', 'Ukraine')" id="uefa-b-semi1-ukraine">Ukraine</div>
                            <div class="playoff-team" onclick="selectPlayoffWinner('uefa-b-semi1', 'Sweden')" id="uefa-b-semi1-sweden">Sweden</div>
                        </div>
                    </div>
                    <div style="background: rgba(255,255,255,0.15); border-radius: 8px; padding: 15px; margin: 10px 0;">
                        <strong>Semifinal 2:</strong><br>
                        <div class="playoff-match">
                            <div class="playoff-team" onclick="selectPlayoffWinner('uefa-b-semi2', 'Poland')" id="uefa-b-semi2-poland">Poland</div>
                            <div class="playoff-team" onclick="selectPlayoffWinner('uefa-b-semi2', 'Albania')" id="uefa-b-semi2-albania">Albania</div>
                        </div>
                    </div>
                    <div style="text-align: center; margin: 15px 0; font-size: 1.5em;">‚¨á</div>
                    <div style="background: rgba(255,255,255,0.25); border-radius: 8px; padding: 15px; margin: 10px 0; font-weight: bold;">
                        <strong>Final:</strong><br>
                        <div class="playoff-match">
                            <div class="playoff-team" id="uefa-b-final-semi1" style="opacity: 0.5; cursor: not-allowed;">Winner Semi 1</div>
                            <div class="playoff-team" id="uefa-b-final-semi2" style="opacity: 0.5; cursor: not-allowed;">Winner Semi 2</div>
                        </div>
                    </div>
                    <div style="text-align: center; margin-top: 15px; padding: 10px; background: rgba(255,215,0,0.3); border-radius: 6px; font-weight: bold;">
                        ‚Üí Group F (European Play-Off B)
                    </div>
                </div>

                <div style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); border-radius: 12px; padding: 25px; color: white; box-shadow: 0 4px 15px rgba(0,0,0,0.2);">
                    <h3 style="text-align: center; font-size: 1.5em; margin-bottom: 20px; border-bottom: 2px solid rgba(255,255,255,0.3); padding-bottom: 10px;">PATH C</h3>
                    <div style="background: rgba(255,255,255,0.15); border-radius: 8px; padding: 15px; margin: 10px 0;">
                        <strong>Semifinal 1:</strong><br>
                        <div class="playoff-match">
                            <div class="playoff-team" onclick="selectPlayoffWinner('uefa-c-semi1', 'T√ºrkiye')" id="uefa-c-semi1-turkiye">T√ºrkiye</div>
                            <div class="playoff-team" onclick="selectPlayoffWinner('uefa-c-semi1', 'Romania')" id="uefa-c-semi1-romania">Romania</div>
                        </div>
                    </div>
                    <div style="background: rgba(255,255,255,0.15); border-radius: 8px; padding: 15px; margin: 10px 0;">
                        <strong>Semifinal 2:</strong><br>
                        <div class="playoff-match">
                            <div class="playoff-team" onclick="selectPlayoffWinner('uefa-c-semi2', 'Slovakia')" id="uefa-c-semi2-slovakia">Slovakia</div>
                            <div class="playoff-team" onclick="selectPlayoffWinner('uefa-c-semi2', 'Kosovo')" id="uefa-c-semi2-kosovo">Kosovo</div>
                        </div>
                    </div>
                    <div style="text-align: center; margin: 15px 0; font-size: 1.5em;">‚¨á</div>
                    <div style="background: rgba(255,255,255,0.25); border-radius: 8px; padding: 15px; margin: 10px 0; font-weight: bold;">
                        <strong>Final:</strong><br>
                        <div class="playoff-match">
                            <div class="playoff-team" id="uefa-c-final-semi1" style="opacity: 0.5; cursor: not-allowed;">Winner Semi 1</div>
                            <div class="playoff-team" id="uefa-c-final-semi2" style="opacity: 0.5; cursor: not-allowed;">Winner Semi 2</div>
                        </div>
                    </div>
                    <div style="text-align: center; margin-top: 15px; padding: 10px; background: rgba(255,215,0,0.3); border-radius: 6px; font-weight: bold;">
                        ‚Üí Group D (European Play-Off C)
                    </div>
                </div>

                <div style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); border-radius: 12px; padding: 25px; color: white; box-shadow: 0 4px 15px rgba(0,0,0,0.2);">
                    <h3 style="text-align: center; font-size: 1.5em; margin-bottom: 20px; border-bottom: 2px solid rgba(255,255,255,0.3); padding-bottom: 10px;">PATH D</h3>
                    <div style="background: rgba(255,255,255,0.15); border-radius: 8px; padding: 15px; margin: 10px 0;">
                        <strong>Semifinal 1:</strong><br>
                        <div class="playoff-match">
                            <div class="playoff-team" onclick="selectPlayoffWinner('uefa-d-semi1', 'Denmark')" id="uefa-d-semi1-denmark">Denmark</div>
                            <div class="playoff-team" onclick="selectPlayoffWinner('uefa-d-semi1', 'North Macedonia')" id="uefa-d-semi1-northmacedonia">North Macedonia</div>
                        </div>
                    </div>
                    <div style="background: rgba(255,255,255,0.15); border-radius: 8px; padding: 15px; margin: 10px 0;">
                        <strong>Semifinal 2:</strong><br>
                        <div class="playoff-match">
                            <div class="playoff-team" onclick="selectPlayoffWinner('uefa-d-semi2', 'Czechia')" id="uefa-d-semi2-czechia">Czechia</div>
                            <div class="playoff-team" onclick="selectPlayoffWinner('uefa-d-semi2', 'Republic of Ireland')" id="uefa-d-semi2-ireland">Republic of Ireland</div>
                        </div>
                    </div>
                    <div style="text-align: center; margin: 15px 0; font-size: 1.5em;">‚¨á</div>
                    <div style="background: rgba(255,255,255,0.25); border-radius: 8px; padding: 15px; margin: 10px 0; font-weight: bold;">
                        <strong>Final:</strong><br>
                        <div class="playoff-match">
                            <div class="playoff-team" id="uefa-d-final-semi1" style="opacity: 0.5; cursor: not-allowed;">Winner Semi 1</div>
                            <div class="playoff-team" id="uefa-d-final-semi2" style="opacity: 0.5; cursor: not-allowed;">Winner Semi 2</div>
                        </div>
                    </div>
                    <div style="text-align: center; margin-top: 15px; padding: 10px; background: rgba(255,215,0,0.3); border-radius: 6px; font-weight: bold;">
                        ‚Üí Group A (European Play-Off D)
                    </div>
                </div>
            </div>

            <div style="background: #e3f2fd; border: 2px solid #2196F3; border-radius: 10px; padding: 20px; margin-top: 40px; text-align: center;">
                <h3 style="color: #1976d2; margin-bottom: 10px;">Timeline</h3>
                <p style="color: #424242; line-height: 1.8;">
                    <strong>March 23-31, 2026:</strong> All playoff matches completed<br>
                    <strong>End of March:</strong> All 48 teams confirmed and placed in groups<br>
                    <strong>June 11, 2026:</strong> World Cup begins in Mexico City
                </p>
            </div>
            
            <button class="reset-btn" onclick="resetPlayoffs()">Reset Playoff Selections</button>
        </div>
        
        <div id="groups" class="tab-content">
            <div class="instructions">
                <strong>Instructions:</strong> Click on teams to select winners (1st), runners-up (2nd), and third-place teams. 
                Top 2 from each group + 8 best third-place teams advance to Round of 32.
                <br><br>
                <strong>Note:</strong> Complete the Playoffs tab first to populate all teams in the groups!
            </div>
            
            <div class="legend">
                <div class="legend-item">
                    <div class="legend-box winner-box"></div>
                    <span>1st Place (Advances)</span>
                </div>
                <div class="legend-item">
                    <div class="legend-box runner-up-box"></div>
                    <span>2nd Place (Advances)</span>
                </div>
                <div class="legend-item">
                    <div class="legend-box third-place-box"></div>
                    <span>3rd Place (8 best advance)</span>
                </div>
            </div>
            
            <div id="groupsGrid" class="groups-grid"></div>
            
            <button class="reset-btn" onclick="resetGroups()">Reset Group Selections</button>
        </div>
        
        <div id="bracket" class="tab-content">
            <div class="instructions">
                <strong>Instructions:</strong> Click on teams in each match to select the winner and progress through the tournament.
            </div>
            
            <div class="bracket-container">
                <div id="bracketDisplay" class="bracket"></div>
            </div>
            
            <div id="championDisplay"></div>
            
            <button class="reset-btn" onclick="resetBracket()">Reset Bracket</button>
        </div>
    </div>

    <script>
        const groups = {
            'A': ['Mexico', 'South Africa', 'Korea Republic', 'European Play-Off D'],
            'B': ['Canada', 'European Play-Off A', 'Qatar', 'Switzerland'],
            'C': ['Brazil', 'Morocco', 'Haiti', 'Scotland'],
            'D': ['USA', 'Paraguay', 'Australia', 'European Play-Off C'],
            'E': ['Germany', 'Cura√ßao', 'C√¥te d\'Ivoire', 'Ecuador'],
            'F': ['Netherlands', 'Japan', 'European Play-Off B', 'Tunisia'],
            'G': ['Belgium', 'Egypt', 'IR Iran', 'New Zealand'],
            'H': ['Spain', 'Cabo Verde', 'Saudi Arabia', 'Uruguay'],
            'I': ['France', 'Senegal', 'FIFA Play-Off Tournament 2', 'Norway'],
            'J': ['Argentina', 'Algeria', 'Austria', 'Jordan'],
            'K': ['Portugal', 'FIFA Play-Off Tournament 1', 'Uzbekistan', 'Colombia'],
            'L': ['England', 'Croatia', 'Ghana', 'Panama']
        };

        let groupSelections = {};
        let bracketSelections = {};
        let playoffSelections = {
            'inter-path1-semi': null,
            'inter-path1-final': null,
            'inter-path2-semi': null,
            'inter-path2-final': null,
            'uefa-a-semi1': null,
            'uefa-a-semi2': null,
            'uefa-a-final': null,
            'uefa-b-semi1': null,
            'uefa-b-semi2': null,
            'uefa-b-final': null,
            'uefa-c-semi1': null,
            'uefa-c-semi2': null,
            'uefa-c-final': null,
            'uefa-d-semi1': null,
            'uefa-d-semi2': null,
            'uefa-d-final': null
        };

        function initGroups() {
            const grid = document.getElementById('groupsGrid');
            grid.innerHTML = '';
            
            Object.keys(groups).forEach(groupName => {
                const groupDiv = document.createElement('div');
                groupDiv.className = 'group';
                groupDiv.innerHTML = `
                    <div class="group-header">Group ${groupName}</div>
                    ${groups[groupName].map((team, idx) => 
                        `<div class="team" data-group="${groupName}" data-idx="${idx}">${team}</div>`
                    ).join('')}
                `;
                grid.appendChild(groupDiv);
            });
            
            // Remove old event listener if it exists
            const oldGrid = document.getElementById('groupsGrid');
            const newGrid = oldGrid.cloneNode(true);
            oldGrid.parentNode.replaceChild(newGrid, oldGrid);
            
            // Add event delegation for team clicks
            document.getElementById('groupsGrid').addEventListener('click', function(e) {
                if (e.target.classList.contains('team')) {
                    const groupName = e.target.dataset.group;
                    const idx = parseInt(e.target.dataset.idx);
                    const team = groups[groupName][idx];
                    selectTeam(groupName, team);
                }
            });
            
            if (!groupSelections || Object.keys(groupSelections).length === 0) {
                groupSelections = {};
                Object.keys(groups).forEach(group => {
                    groupSelections[group] = { winner: null, runnerUp: null, third: null };
                });
            }
            updateGroupDisplay();
        }

        function selectTeam(group, team) {
            const sel = groupSelections[group];
            
            if (sel.winner === team) {
                sel.winner = null;
            } else if (sel.runnerUp === team) {
                sel.runnerUp = null;
            } else if (sel.third === team) {
                sel.third = null;
            } else if (!sel.winner) {
                sel.winner = team;
            } else if (!sel.runnerUp) {
                sel.runnerUp = team;
            } else if (!sel.third) {
                sel.third = team;
            } else {
                sel.third = team;
            }
            
            updateGroupDisplay();
        }

        function updateGroupDisplay() {
            Object.keys(groups).forEach(groupName => {
                groups[groupName].forEach(team => {
                    const teamElements = document.querySelectorAll('.team');
                    teamElements.forEach(el => {
                        if (el.textContent === team) {
                            el.classList.remove('winner', 'runner-up', 'third-place');
                            const sel = groupSelections[groupName];
                            if (sel.winner === team) el.classList.add('winner');
                            if (sel.runnerUp === team) el.classList.add('runner-up');
                            if (sel.third === team) el.classList.add('third-place');
                        }
                    });
                });
            });
        }

        function getQualifiedTeams() {
            const qualified = [];
            
            // Add all winners and runners-up
            Object.keys(groups).forEach(group => {
                const sel = groupSelections[group];
                if (sel.winner) qualified.push({ team: sel.winner, group, position: 1 });
                if (sel.runnerUp) qualified.push({ team: sel.runnerUp, group, position: 2 });
            });
            
            // Add best 8 third-place teams
            const thirdPlace = [];
            Object.keys(groups).forEach(group => {
                const sel = groupSelections[group];
                if (sel.third) thirdPlace.push({ team: sel.third, group, position: 3 });
            });
            
            // For simplicity, take first 8 third-place teams
            thirdPlace.slice(0, 8).forEach(t => qualified.push(t));
            
            return qualified;
        }

        function generateBracket() {
            const qualified = getQualifiedTeams();
            
            if (qualified.length < 32) {
                alert('Please select winners, runners-up, and third-place teams for all groups first!');
                return;
            }

            // Extract teams by position
            const winners = {};
            const runnersUp = {};
            const thirdPlace = [];
            
            qualified.forEach(q => {
                if (q.position === 1) winners[q.group] = q.team;
                else if (q.position === 2) runnersUp[q.group] = q.team;
                else if (q.position === 3) thirdPlace.push({ team: q.team, group: q.group });
            });
            
            // For third place teams, we need to determine which slots they fill
            // This is complex - for now we'll use placeholder logic
            const thirdPlaceSlots = {
                'A/B/C/D/F': thirdPlace[0]?.team || 'TBD 3rd',
                'C/D/F/G/H': thirdPlace[1]?.team || 'TBD 3rd',
                'C/E/F/H/I': thirdPlace[2]?.team || 'TBD 3rd',
                'E/H/I/J/K': thirdPlace[3]?.team || 'TBD 3rd',
                'B/E/F/I/J': thirdPlace[4]?.team || 'TBD 3rd',
                'A/E/H/I/J': thirdPlace[5]?.team || 'TBD 3rd',
                'E/F/G/I/J': thirdPlace[6]?.team || 'TBD 3rd',
                'D/E/I/J/L': thirdPlace[7]?.team || 'TBD 3rd'
            };

            // Official Round of 32 matchups
            const round32 = [
                { id: 73, team1: runnersUp['A'] || 'TBD', team2: runnersUp['B'] || 'TBD', venue: 'Los Angeles', winner: null },
                { id: 74, team1: winners['E'] || 'TBD', team2: thirdPlaceSlots['A/B/C/D/F'], venue: 'Boston', winner: null },
                { id: 75, team1: winners['F'] || 'TBD', team2: runnersUp['C'] || 'TBD', venue: 'Monterrey', winner: null },
                { id: 76, team1: winners['C'] || 'TBD', team2: runnersUp['F'] || 'TBD', venue: 'Houston', winner: null },
                { id: 77, team1: winners['I'] || 'TBD', team2: thirdPlaceSlots['C/D/F/G/H'], venue: 'New York/NJ', winner: null },
                { id: 78, team1: runnersUp['E'] || 'TBD', team2: runnersUp['I'] || 'TBD', venue: 'Dallas', winner: null },
                { id: 79, team1: winners['A'] || 'TBD', team2: thirdPlaceSlots['C/E/F/H/I'], venue: 'Mexico City', winner: null },
                { id: 80, team1: winners['L'] || 'TBD', team2: thirdPlaceSlots['E/H/I/J/K'], venue: 'Atlanta', winner: null },
                { id: 81, team1: winners['D'] || 'TBD', team2: thirdPlaceSlots['B/E/F/I/J'], venue: 'San Francisco', winner: null },
                { id: 82, team1: winners['G'] || 'TBD', team2: thirdPlaceSlots['A/E/H/I/J'], venue: 'Seattle', winner: null },
                { id: 83, team1: runnersUp['K'] || 'TBD', team2: runnersUp['L'] || 'TBD', venue: 'Toronto', winner: null },
                { id: 84, team1: winners['H'] || 'TBD', team2: runnersUp['J'] || 'TBD', venue: 'Los Angeles', winner: null },
                { id: 85, team1: winners['B'] || 'TBD', team2: thirdPlaceSlots['E/F/G/I/J'], venue: 'Vancouver', winner: null },
                { id: 86, team1: winners['J'] || 'TBD', team2: runnersUp['H'] || 'TBD', venue: 'Miami', winner: null },
                { id: 87, team1: winners['K'] || 'TBD', team2: thirdPlaceSlots['D/E/I/J/L'], venue: 'Kansas City', winner: null },
                { id: 88, team1: runnersUp['D'] || 'TBD', team2: runnersUp['G'] || 'TBD', venue: 'Dallas', winner: null }
            ];

            // Round of 16 matchups
            const round16 = [
                { id: 89, team1: 'W74', team2: 'W77', venue: 'Philadelphia', winner: null },
                { id: 90, team1: 'W73', team2: 'W75', venue: 'Houston', winner: null },
                { id: 91, team1: 'W76', team2: 'W78', venue: 'New York/NJ', winner: null },
                { id: 92, team1: 'W79', team2: 'W80', venue: 'Mexico City', winner: null },
                { id: 93, team1: 'W83', team2: 'W84', venue: 'Dallas', winner: null },
                { id: 94, team1: 'W81', team2: 'W82', venue: 'Seattle', winner: null },
                { id: 95, team1: 'W86', team2: 'W88', venue: 'Atlanta', winner: null },
                { id: 96, team1: 'W85', team2: 'W87', venue: 'Vancouver', winner: null }
            ];

            // Quarter-finals
            const quarterfinals = [
                { id: 97, team1: 'W89', team2: 'W90', venue: 'Boston', winner: null },
                { id: 98, team1: 'W93', team2: 'W94', venue: 'Los Angeles', winner: null },
                { id: 99, team1: 'W91', team2: 'W92', venue: 'Miami', winner: null },
                { id: 100, team1: 'W95', team2: 'W96', venue: 'Kansas City', winner: null }
            ];

            // Semi-finals
            const semifinals = [
                { id: 101, team1: 'W97', team2: 'W98', venue: 'Dallas', winner: null },
                { id: 102, team1: 'W99', team2: 'W100', venue: 'Atlanta', winner: null }
            ];

            // Third place match
            const thirdPlaceMatch = { id: 103, team1: 'L101', team2: 'L102', venue: 'Miami', winner: null };

            // Final
            const final = { id: 104, team1: 'W101', team2: 'W102', venue: 'New York/NJ', winner: null };

            return {
                round32: round32,
                round16: round16,
                quarterfinals: quarterfinals,
                semifinals: semifinals,
                thirdPlace: thirdPlaceMatch,
                final: final
            };
        }

        function displayBracket() {
            const bracket = generateBracket();
            if (!bracket) return;

            const display = document.getElementById('bracketDisplay');
            display.innerHTML = '';

            // Round of 32
            const round32Div = createRoundWithVenues('Round of 32', bracket.round32, 'round32');
            display.appendChild(round32Div);

            // Round of 16
            const round16Div = createRoundWithVenues('Round of 16', bracket.round16, 'round16');
            display.appendChild(round16Div);

            // Quarter-finals
            const quarterDiv = createRoundWithVenues('Quarter-finals', bracket.quarterfinals, 'quarterfinals');
            display.appendChild(quarterDiv);

            // Semi-finals
            const semiDiv = createRoundWithVenues('Semi-finals', bracket.semifinals, 'semifinals');
            display.appendChild(semiDiv);

            // Third Place & Final container
            const finalsDiv = document.createElement('div');
            finalsDiv.className = 'round';
            finalsDiv.innerHTML = `<div class="round-title">Finals</div>`;
            
            // Third place match
            const thirdDiv = createMatchElement(bracket.thirdPlace, 'thirdPlace', 0, true);
            finalsDiv.appendChild(thirdDiv);
            
            // Final match
            const finalDiv = createMatchElement(bracket.final, 'final', 0, true);
            finalsDiv.appendChild(finalDiv);
            
            display.appendChild(finalsDiv);
        }

        function createRoundWithVenues(title, matches, roundKey) {
            const roundDiv = document.createElement('div');
            roundDiv.className = 'round';
            roundDiv.innerHTML = `<div class="round-title">${title}</div>`;

            matches.forEach((match, idx) => {
                const matchDiv = createMatchElement(match, roundKey, idx);
                roundDiv.appendChild(matchDiv);
            });

            return roundDiv;
        }

        function createMatchElement(match, roundKey, idx, showMatchId = false) {
            const matchDiv = document.createElement('div');
            matchDiv.className = 'match';
            
            let titleHtml = '';
            if (showMatchId && match.id) {
                titleHtml = `<div style="font-size: 0.85em; color: #666; margin-bottom: 5px;">Match ${match.id}</div>`;
            }
            if (match.venue) {
                titleHtml += `<div style="font-size: 0.85em; color: #666; margin-bottom: 5px;">üìç ${match.venue}</div>`;
            }
            
            matchDiv.innerHTML = titleHtml;
            
            // Resolve team names if they're placeholders like 'W74'
            const team1Display = resolveTeamName(match.team1, roundKey, idx);
            const team2Display = resolveTeamName(match.team2, roundKey, idx);
            
            const team1Div = document.createElement('div');
            team1Div.className = 'match-team';
            if (bracketSelections[`${roundKey}-${idx}`] === team1Display) {
                team1Div.classList.add('selected');
            }
            team1Div.textContent = team1Display;
            team1Div.onclick = () => {
                if (team1Display !== 'TBD' && !team1Display.startsWith('W') && !team1Display.startsWith('L')) {
                    selectWinnerByMatch(roundKey, idx, team1Display, match.id);
                }
            };

            const team2Div = document.createElement('div');
            team2Div.className = 'match-team';
            if (bracketSelections[`${roundKey}-${idx}`] === team2Display) {
                team2Div.classList.add('selected');
            }
            team2Div.textContent = team2Display;
            team2Div.onclick = () => {
                if (team2Display !== 'TBD' && !team2Display.startsWith('W') && !team2Display.startsWith('L')) {
                    selectWinnerByMatch(roundKey, idx, team2Display, match.id);
                }
            };

            matchDiv.appendChild(team1Div);
            matchDiv.appendChild(team2Div);
            
            return matchDiv;
        }

        function resolveTeamName(teamIdentifier, roundKey, idx) {
            if (!teamIdentifier || teamIdentifier === 'TBD') return 'TBD';
            
            // Check if it's a placeholder like 'W74' or 'L101'
            if (teamIdentifier.startsWith('W')) {
                const matchId = parseInt(teamIdentifier.substring(1));
                return getWinnerOfMatch(matchId) || `Winner M${matchId}`;
            }
            if (teamIdentifier.startsWith('L')) {
                const matchId = parseInt(teamIdentifier.substring(1));
                return getLoserOfMatch(matchId) || `Loser M${matchId}`;
            }
            
            return teamIdentifier;
        }

        function getWinnerOfMatch(matchId) {
            // Search through all bracket levels for this match ID
            const bracket = generateBracket();
            
            // Check round32
            const r32Match = bracket.round32.find(m => m.id === matchId);
            if (r32Match) {
                const key = `round32-${bracket.round32.indexOf(r32Match)}`;
                return bracketSelections[key];
            }
            
            // Check round16
            const r16Match = bracket.round16.find(m => m.id === matchId);
            if (r16Match) {
                const key = `round16-${bracket.round16.indexOf(r16Match)}`;
                return bracketSelections[key];
            }
            
            // Check quarterfinals
            const qfMatch = bracket.quarterfinals.find(m => m.id === matchId);
            if (qfMatch) {
                const key = `quarterfinals-${bracket.quarterfinals.indexOf(qfMatch)}`;
                return bracketSelections[key];
            }
            
            // Check semifinals
            const sfMatch = bracket.semifinals.find(m => m.id === matchId);
            if (sfMatch) {
                const key = `semifinals-${bracket.semifinals.indexOf(sfMatch)}`;
                return bracketSelections[key];
            }
            
            return null;
        }

        function getLoserOfMatch(matchId) {
            const winner = getWinnerOfMatch(matchId);
            if (!winner) return null;
            
            const bracket = generateBracket();
            const sfMatch = bracket.semifinals.find(m => m.id === matchId);
            if (sfMatch) {
                const team1 = resolveTeamName(sfMatch.team1);
                const team2 = resolveTeamName(sfMatch.team2);
                return winner === team1 ? team2 : team1;
            }
            
            return null;
        }

        function selectWinnerByMatch(roundKey, matchIdx, team, matchId) {
            if (team === 'TBD') return;

            bracketSelections[`${roundKey}-${matchIdx}`] = team;
            
            displayBracket();
            checkChampion();
        }

        function checkChampion() {
            const champion = bracketSelections['final-0'];
            const display = document.getElementById('championDisplay');
            
            if (champion && champion !== 'TBD') {
                display.innerHTML = `
                    <div class="champion-display">
                        <h2>üèÜ 2026 WORLD CHAMPION üèÜ</h2>
                        <div class="champion-name">${champion}</div>
                    </div>
                `;
            } else {
                display.innerHTML = '';
            }
        }

        function showTab(tabName) {
            document.querySelectorAll('.tab').forEach(tab => tab.classList.remove('active'));
            document.querySelectorAll('.tab-content').forEach(content => content.classList.remove('active'));
            
            event.target.classList.add('active');
            document.getElementById(tabName).classList.add('active');
            
            // Update workflow guide
            const guideText = document.getElementById('guideText');
            if (tabName === 'playoffs') {
                guideText.innerHTML = 'üëâ Step 1: Complete the Playoffs to determine all 48 teams!';
            } else if (tabName === 'groups') {
                guideText.innerHTML = 'üëâ Step 2: Select group winners, runners-up, and third-place teams (32 teams advance)';
            } else if (tabName === 'bracket') {
                guideText.innerHTML = 'üëâ Step 3: Click through the knockout rounds to crown a champion!';
            }
            
            if (tabName === 'bracket') {
                displayBracket();
            }
        }

        function resetGroups() {
            groupSelections = {};
            Object.keys(groups).forEach(group => {
                groupSelections[group] = { winner: null, runnerUp: null, third: null };
            });
            initGroups();
        }

        function resetBracket() {
            bracketSelections = {};
            displayBracket();
            document.getElementById('championDisplay').innerHTML = '';
        }

        function selectPlayoffWinner(matchId, team) {
            playoffSelections[matchId] = team;
            
            // Update visual selection - need to handle team names with special characters
            document.querySelectorAll(`[id^="${matchId}-"]`).forEach(el => {
                el.classList.remove('selected');
            });
            
            const teamId = team.toLowerCase().replace(/\s+/g, '').replace(/[^a-z0-9]/g, '');
            const selectedElement = document.getElementById(`${matchId}-${teamId}`);
            if (selectedElement) {
                selectedElement.classList.add('selected');
            }
            
            // Progress winners to finals
            updatePlayoffProgression();
            
            // Update groups with playoff winners
            updateGroupsWithPlayoffWinners();
        }

        function updatePlayoffProgression() {
            // Inter-confederation Path 1
            if (playoffSelections['inter-path1-semi']) {
                let finalEl = document.getElementById('inter-path1-final-semifinalist');
                if (!finalEl) {
                    // If the original ID doesn't exist, try to find it by looking for elements in that match
                    const parent = document.querySelector('[id*="inter-path1-final"]')?.closest('.playoff-match');
                    if (parent) {
                        finalEl = parent.querySelector('.playoff-team:not([id*="congodr"])');
                    }
                }
                if (finalEl) {
                    const winner = playoffSelections['inter-path1-semi'];
                    finalEl.textContent = winner;
                    finalEl.style.opacity = '1';
                    finalEl.style.cursor = 'pointer';
                    const winnerId = 'inter-path1-final-' + winner.toLowerCase().replace(/\s+/g, '').replace(/[^a-z0-9]/g, '');
                    finalEl.setAttribute('data-original-id', 'inter-path1-final-semifinalist');
                    finalEl.id = winnerId;
                    finalEl.onclick = () => selectPlayoffWinner('inter-path1-final', winner);
                }
            }
            
            // Inter-confederation Path 2
            if (playoffSelections['inter-path2-semi']) {
                let finalEl = document.getElementById('inter-path2-final-semifinalist');
                if (!finalEl) {
                    const parent = document.querySelector('[id*="inter-path2-final"]')?.closest('.playoff-match');
                    if (parent) {
                        finalEl = parent.querySelector('.playoff-team:not([id*="iraq"])');
                    }
                }
                if (finalEl) {
                    const winner = playoffSelections['inter-path2-semi'];
                    finalEl.textContent = winner;
                    finalEl.style.opacity = '1';
                    finalEl.style.cursor = 'pointer';
                    const winnerId = 'inter-path2-final-' + winner.toLowerCase().replace(/\s+/g, '').replace(/[^a-z0-9]/g, '');
                    finalEl.setAttribute('data-original-id', 'inter-path2-final-semifinalist');
                    finalEl.id = winnerId;
                    finalEl.onclick = () => selectPlayoffWinner('inter-path2-final', winner);
                }
            }
            
            // UEFA Path A
            if (playoffSelections['uefa-a-semi1']) {
                let finalEl = document.getElementById('uefa-a-final-semi1');
                if (!finalEl) {
                    finalEl = document.querySelector('[data-original-id="uefa-a-final-semi1"]');
                }
                if (finalEl) {
                    const winner = playoffSelections['uefa-a-semi1'];
                    finalEl.textContent = winner;
                    finalEl.style.opacity = '1';
                    finalEl.style.cursor = 'pointer';
                    const winnerId = 'uefa-a-final-' + winner.toLowerCase().replace(/\s+/g, '').replace(/[^a-z0-9]/g, '');
                    finalEl.setAttribute('data-original-id', 'uefa-a-final-semi1');
                    finalEl.id = winnerId;
                    finalEl.onclick = () => selectPlayoffWinner('uefa-a-final', winner);
                }
            }
            if (playoffSelections['uefa-a-semi2']) {
                let finalEl = document.getElementById('uefa-a-final-semi2');
                if (!finalEl) {
                    finalEl = document.querySelector('[data-original-id="uefa-a-final-semi2"]');
                }
                if (finalEl) {
                    const winner = playoffSelections['uefa-a-semi2'];
                    finalEl.textContent = winner;
                    finalEl.style.opacity = '1';
                    finalEl.style.cursor = 'pointer';
                    const winnerId = 'uefa-a-final-' + winner.toLowerCase().replace(/\s+/g, '').replace(/[^a-z0-9]/g, '');
                    finalEl.setAttribute('data-original-id', 'uefa-a-final-semi2');
                    finalEl.id = winnerId;
                    finalEl.onclick = () => selectPlayoffWinner('uefa-a-final', winner);
                }
            }
            
            // UEFA Path B
            if (playoffSelections['uefa-b-semi1']) {
                let finalEl = document.getElementById('uefa-b-final-semi1');
                if (!finalEl) {
                    finalEl = document.querySelector('[data-original-id="uefa-b-final-semi1"]');
                }
                if (finalEl) {
                    const winner = playoffSelections['uefa-b-semi1'];
                    finalEl.textContent = winner;
                    finalEl.style.opacity = '1';
                    finalEl.style.cursor = 'pointer';
                    const winnerId = 'uefa-b-final-' + winner.toLowerCase().replace(/\s+/g, '').replace(/[^a-z0-9]/g, '');
                    finalEl.setAttribute('data-original-id', 'uefa-b-final-semi1');
                    finalEl.id = winnerId;
                    finalEl.onclick = () => selectPlayoffWinner('uefa-b-final', winner);
                }
            }
            if (playoffSelections['uefa-b-semi2']) {
                let finalEl = document.getElementById('uefa-b-final-semi2');
                if (!finalEl) {
                    finalEl = document.querySelector('[data-original-id="uefa-b-final-semi2"]');
                }
                if (finalEl) {
                    const winner = playoffSelections['uefa-b-semi2'];
                    finalEl.textContent = winner;
                    finalEl.style.opacity = '1';
                    finalEl.style.cursor = 'pointer';
                    const winnerId = 'uefa-b-final-' + winner.toLowerCase().replace(/\s+/g, '').replace(/[^a-z0-9]/g, '');
                    finalEl.setAttribute('data-original-id', 'uefa-b-final-semi2');
                    finalEl.id = winnerId;
                    finalEl.onclick = () => selectPlayoffWinner('uefa-b-final', winner);
                }
            }
            
            // UEFA Path C
            if (playoffSelections['uefa-c-semi1']) {
                let finalEl = document.getElementById('uefa-c-final-semi1');
                if (!finalEl) {
                    finalEl = document.querySelector('[data-original-id="uefa-c-final-semi1"]');
                }
                if (finalEl) {
                    const winner = playoffSelections['uefa-c-semi1'];
                    finalEl.textContent = winner;
                    finalEl.style.opacity = '1';
                    finalEl.style.cursor = 'pointer';
                    const winnerId = 'uefa-c-final-' + winner.toLowerCase().replace(/\s+/g, '').replace(/[^a-z0-9]/g, '');
                    finalEl.setAttribute('data-original-id', 'uefa-c-final-semi1');
                    finalEl.id = winnerId;
                    finalEl.onclick = () => selectPlayoffWinner('uefa-c-final', winner);
                }
            }
            if (playoffSelections['uefa-c-semi2']) {
                let finalEl = document.getElementById('uefa-c-final-semi2');
                if (!finalEl) {
                    finalEl = document.querySelector('[data-original-id="uefa-c-final-semi2"]');
                }
                if (finalEl) {
                    const winner = playoffSelections['uefa-c-semi2'];
                    finalEl.textContent = winner;
                    finalEl.style.opacity = '1';
                    finalEl.style.cursor = 'pointer';
                    const winnerId = 'uefa-c-final-' + winner.toLowerCase().replace(/\s+/g, '').replace(/[^a-z0-9]/g, '');
                    finalEl.setAttribute('data-original-id', 'uefa-c-final-semi2');
                    finalEl.id = winnerId;
                    finalEl.onclick = () => selectPlayoffWinner('uefa-c-final', winner);
                }
            }
            
            // UEFA Path D
            if (playoffSelections['uefa-d-semi1']) {
                let finalEl = document.getElementById('uefa-d-final-semi1');
                if (!finalEl) {
                    finalEl = document.querySelector('[data-original-id="uefa-d-final-semi1"]');
                }
                if (finalEl) {
                    const winner = playoffSelections['uefa-d-semi1'];
                    finalEl.textContent = winner;
                    finalEl.style.opacity = '1';
                    finalEl.style.cursor = 'pointer';
                    const winnerId = 'uefa-d-final-' + winner.toLowerCase().replace(/\s+/g, '').replace(/[^a-z0-9]/g, '');
                    finalEl.setAttribute('data-original-id', 'uefa-d-final-semi1');
                    finalEl.id = winnerId;
                    finalEl.onclick = () => selectPlayoffWinner('uefa-d-final', winner);
                }
            }
            if (playoffSelections['uefa-d-semi2']) {
                let finalEl = document.getElementById('uefa-d-final-semi2');
                if (!finalEl) {
                    finalEl = document.querySelector('[data-original-id="uefa-d-final-semi2"]');
                }
                if (finalEl) {
                    const winner = playoffSelections['uefa-d-semi2'];
                    finalEl.textContent = winner;
                    finalEl.style.opacity = '1';
                    finalEl.style.cursor = 'pointer';
                    const winnerId = 'uefa-d-final-' + winner.toLowerCase().replace(/\s+/g, '').replace(/[^a-z0-9]/g, '');
                    finalEl.setAttribute('data-original-id', 'uefa-d-final-semi2');
                    finalEl.id = winnerId;
                    finalEl.onclick = () => selectPlayoffWinner('uefa-d-final', winner);
                }
            }
            
            // Check if all playoffs are complete
            checkPlayoffCompletion();
        }

        function checkPlayoffCompletion() {
            const allComplete = 
                playoffSelections['inter-path1-final'] &&
                playoffSelections['inter-path2-final'] &&
                playoffSelections['uefa-a-final'] &&
                playoffSelections['uefa-b-final'] &&
                playoffSelections['uefa-c-final'] &&
                playoffSelections['uefa-d-final'];
            
            if (allComplete) {
                const guideText = document.getElementById('guideText');
                guideText.innerHTML = '‚úÖ All playoffs complete! Click "2. Group Stage" to continue ‚Üí';
                guideText.style.background = 'linear-gradient(135deg, #2196F3 0%, #1976d2 100%)';
            }
        }

        function updateGroupsWithPlayoffWinners() {
            // Update the groups object with playoff winners
            if (playoffSelections['uefa-a-final']) {
                groups['B'][1] = playoffSelections['uefa-a-final']; // Group B, position 2
            }
            if (playoffSelections['uefa-b-final']) {
                groups['F'][2] = playoffSelections['uefa-b-final']; // Group F, position 3
            }
            if (playoffSelections['uefa-c-final']) {
                groups['D'][3] = playoffSelections['uefa-c-final']; // Group D, position 4
            }
            if (playoffSelections['uefa-d-final']) {
                groups['A'][3] = playoffSelections['uefa-d-final']; // Group A, position 4
            }
            if (playoffSelections['inter-path1-final']) {
                groups['K'][1] = playoffSelections['inter-path1-final']; // Group K, position 2
            }
            if (playoffSelections['inter-path2-final']) {
                groups['I'][2] = playoffSelections['inter-path2-final']; // Group I, position 3
            }
            
            // Always reinitialize groups display to show updated teams
            initGroups();
        }

        function resetPlayoffs() {
            playoffSelections = {
                'inter-path1-semi': null,
                'inter-path1-final': null,
                'inter-path2-semi': null,
                'inter-path2-final': null,
                'uefa-a-semi1': null,
                'uefa-a-semi2': null,
                'uefa-a-final': null,
                'uefa-b-semi1': null,
                'uefa-b-semi2': null,
                'uefa-b-final': null,
                'uefa-c-semi1': null,
                'uefa-c-semi2': null,
                'uefa-c-final': null,
                'uefa-d-semi1': null,
                'uefa-d-semi2': null,
                'uefa-d-final': null
            };
            
            // Reset groups to original values
            groups['A'][3] = 'European Play-Off D';
            groups['B'][1] = 'European Play-Off A';
            groups['D'][3] = 'European Play-Off C';
            groups['F'][2] = 'European Play-Off B';
            groups['I'][2] = 'FIFA Play-Off Tournament 2';
            groups['K'][1] = 'FIFA Play-Off Tournament 1';
            
            // Remove all selected classes
            document.querySelectorAll('.playoff-team.selected').forEach(el => {
                el.classList.remove('selected');
            });
            
            // Reset final match displays
            document.getElementById('inter-path1-final-semifinalist').textContent = 'Winner of Semifinal';
            document.getElementById('inter-path1-final-semifinalist').style.opacity = '0.5';
            document.getElementById('inter-path1-final-semifinalist').style.cursor = 'not-allowed';
            document.getElementById('inter-path1-final-semifinalist').onclick = null;
            
            document.getElementById('inter-path2-final-semifinalist').textContent = 'Winner of Semifinal';
            document.getElementById('inter-path2-final-semifinalist').style.opacity = '0.5';
            document.getElementById('inter-path2-final-semifinalist').style.cursor = 'not-allowed';
            document.getElementById('inter-path2-final-semifinalist').onclick = null;
            
            ['a', 'b', 'c', 'd'].forEach(path => {
                document.getElementById(`uefa-${path}-final-semi1`).textContent = 'Winner Semi 1';
                document.getElementById(`uefa-${path}-final-semi1`).style.opacity = '0.5';
                document.getElementById(`uefa-${path}-final-semi1`).style.cursor = 'not-allowed';
                document.getElementById(`uefa-${path}-final-semi1`).onclick = null;
                
                document.getElementById(`uefa-${path}-final-semi2`).textContent = 'Winner Semi 2';
                document.getElementById(`uefa-${path}-final-semi2`).style.opacity = '0.5';
                document.getElementById(`uefa-${path}-final-semi2`).style.cursor = 'not-allowed';
                document.getElementById(`uefa-${path}-final-semi2`).onclick = null;
            });
            
            // Reset workflow guide
            const guideText = document.getElementById('guideText');
            guideText.innerHTML = 'üëâ Step 1: Complete the Playoffs to determine all 48 teams!';
            guideText.style.background = 'linear-gradient(135deg, #4CAF50 0%, #45a049 100%)';
            
            initGroups();
        }

        // Initialize on load
        initGroups();
    </script>
</body>
</html>
